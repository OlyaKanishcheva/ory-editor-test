{"ast":null,"code":"\"use strict\";\n/*\n * This file is part of ORY Editor.\n *\n * ORY Editor is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ORY Editor is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with ORY Editor.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @license LGPL-3.0\n * @copyright 2016-2018 Aeneas Rekkas\n * @author Aeneas Rekkas <aeneas+oss@aeneas.io>\n *\n */\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  }\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Subject_1 = __importDefault(require(\"@material-ui/icons/Subject\"));\n\nvar ramda_1 = require(\"ramda\");\n\nvar slate_html_serializer_1 = __importDefault(require(\"slate-html-serializer\"));\n\nvar React = __importStar(require(\"react\"));\n\nvar Component_1 = __importDefault(require(\"./Component\"));\n\nvar hooks = __importStar(require(\"./hooks\"));\n\nvar parse5_1 = __importDefault(require(\"parse5\"));\n\nvar v002_1 = __importDefault(require(\"./migrations/v002\"));\n\nvar pathOr_1 = require(\"ramda/src/pathOr\");\n\nvar redux_undo_1 = require(\"redux-undo\");\n\nvar createPlugins = ramda_1.compose(ramda_1.flatten, ramda_1.map(ramda_1.prop('plugins')));\nexports.createInitialState = hooks.createInitialState;\nexports.html = new slate_html_serializer_1.default({\n  rules: hooks.defaultPlugins.concat([hooks.lineBreakSerializer]),\n  parseHtml: parse5_1.default.parseFragment\n});\nexports.defaultPlugins = hooks.defaultPlugins;\n\nexports.default = function (plugins) {\n  if (plugins === void 0) {\n    plugins = hooks.defaultPlugins;\n  }\n\n  var settings = {};\n  settings.plugins = (plugins ? plugins : []).concat(createPlugins(plugins));\n\n  var HoverButtons = function HoverButtons(_a) {\n    var editorState = _a.editorState,\n        editor = _a.editor;\n    return React.createElement(\"div\", null, plugins && plugins.map(function (plugin, i) {\n      return plugin.hoverButtons && plugin.hoverButtons.map(function (Button, j) {\n        return React.createElement(Button, {\n          key: i + \"-\" + j,\n          editorState: editorState,\n          editor: editor\n        });\n      });\n    }));\n  };\n\n  settings.HoverButtons = HoverButtons;\n\n  var ToolbarButtons = function ToolbarButtons(_a) {\n    var editorState = _a.editorState,\n        editor = _a.editor;\n    return React.createElement(\"div\", null, plugins && plugins.map(function (plugin, i) {\n      return plugin.toolbarButtons && plugin.toolbarButtons.map(function (Button, j) {\n        return React.createElement(Button, {\n          key: i + \"-\" + j,\n          editorState: editorState,\n          editor: editor\n        });\n      });\n    }));\n  };\n\n  settings.ToolbarButtons = ToolbarButtons;\n\n  var Slate = function Slate(cellProps) {\n    return React.createElement(Component_1.default, __assign({}, cellProps, settings));\n  };\n\n  var StaticComponent = function StaticComponent(_a) {\n    var _b = _a.state,\n        _c = (_b === void 0 ? {} : _b).editorState,\n        editorState = _c === void 0 ? {} : _c;\n    return React.createElement(\"div\", {\n      className: \"ory-plugins-content-slate-container\",\n      dangerouslySetInnerHTML: {\n        __html: exports.html.serialize(editorState)\n      }\n    });\n  };\n\n  return {\n    Component: Slate,\n    StaticComponent: StaticComponent,\n    name: 'ory/editor/core/content/slate',\n    version: '0.0.2',\n    IconComponent: React.createElement(Subject_1.default, null),\n    text: 'Text',\n    description: 'An advanced rich text area.',\n    allowInlineNeighbours: true,\n\n    /*handleFocus: (_props: SlateProps, source: string) => {\n      if (source === 'onMouseDown') {\n        return;\n      } else if (_props.state.editorState.selection.isFocused) {\n        return;\n      }\n           setTimeout(() => {\n        _props.state.editor && _props.state.editor.focus();\n      }, 0);\n    },\n         handleBlur: (_props: SlateProps) => {\n      if (!_props.state.editorState.selection.isFocused) {\n        return;\n      }\n      _props.onChange({\n        editorState: _props.state.editor && _props.state.editor.blur().value,\n      });\n    },*/\n    // tslint:disable-next-line:no-any\n    reducer: function reducer(state, action) {\n      if ((action.type === redux_undo_1.ActionTypes.UNDO || action.type === redux_undo_1.ActionTypes.REDO) && pathOr_1.pathOr(false, ['content', 'state', 'editorState'], state)) {\n        return __assign({}, state, {\n          content: __assign({}, state.content, {\n            state: __assign({}, state.content.state, {\n              editorState: state.content.state.editorState.merge({\n                isNative: false\n              })\n            })\n          })\n        });\n      }\n\n      return state;\n    },\n    handleRemoveHotKey: hooks.handleRemoveHotKey,\n    handleFocusPreviousHotKey: hooks.handleFocusPreviousHotKey,\n    handleFocusNextHotKey: hooks.handleFocusNextHotKey,\n    createInitialState: hooks.createInitialState,\n    serialize: hooks.serialize,\n    unserialize: hooks.unserialize,\n    // TODO this is disabled because of #207\n    // merge = hooks.merge\n    // split = hooks.split\n    migrations: [v002_1.default]\n  };\n};","map":null,"metadata":{},"sourceType":"script"}